<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visualizing multiHiCcompare results in Juicebox • multiHiCcompare</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Visualizing multiHiCcompare results in Juicebox">
<meta property="og:description" content="multiHiCcompare">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multiHiCcompare</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/multiHiCcompare.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/juiceboxVisualization.html">Visualizing multiHiCcompare results in Juicebox</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dozmorovlab/multiHiCcompare/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="juiceboxVisualization_files/header-attrs-2.3/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Visualizing multiHiCcompare results in Juicebox</h1>
                        <h4 class="author">John C. Stansfield &amp; Mikhail G. Dozmorov</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dozmorovlab/multiHiCcompare/blob/master/vignettes/juiceboxVisualization.Rmd"><code>vignettes/juiceboxVisualization.Rmd</code></a></small>
      <div class="hidden name"><code>juiceboxVisualization.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><code>multiHiCcompare</code> provides a method for detecting significant differentially interacting regions (DIRs) in Hi-C data. These DIRs are represented by pairs of genomic regions changing their interaction strength between conditions. It may be of interest for the user to visualize these DIRs on an interactive chromatin interaction heatmap in order to determine where they occur in relation to each other and numerous genomic annotations. The <code>Juicebox</code> software provided by the Aiden Lab <a href="https://www.aidenlab.org/">https://www.aidenlab.org/</a> can be used to visualize your Hi-C data and <code>multiHiCcompare</code> results.</p>
</div>
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h1>
<p>You will first need to download <code>Juicebox</code> from here: <a href="https://github.com/aidenlab/Juicebox/wiki/Download">https://github.com/aidenlab/Juicebox/wiki/Download</a></p>
<p>Once you have downloaded and installed <code>Juicebox</code> you may want to go through the provided tutorial here: <a href="https://github.com/aidenlab/Juicebox/wiki/Visualization">https://github.com/aidenlab/Juicebox/wiki/Visualization</a></p>
<p>If the Hi-C data you are analyzing was originally generated by the Aiden Lab, the data should be available in <code>Juicebox</code> by default. You will not need to perform any extra steps to open the heatmap, simply find your dataset under the <code>File &gt; Open</code> menu in <code>Juicebox</code>. If your data did not originally generate by the Aiden Lab, you will need to obtain it in the form of a <code>.hic</code> file. <code>.hic</code> files can be read into <code>Juicebox</code> using the <code>File &gt; Open &gt; Local...</code> menu. If your data is not in the form of a <code>.hic</code> file you will need to convert it to a <code>.hic</code> file. This can be done using the <code>Juicer tools</code> command <code>pre</code>. Instructions for this process can be found here: <a href="https://github.com/aidenlab/juicer/wiki/Pre">https://github.com/aidenlab/juicer/wiki/Pre</a>.</p>
</div>
<div id="example" class="section level1">
<h1 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h1>
<p>For our example, we will use the data from Rao 2017. We compared the data between the normal HCT-116 cells and the cells treated with auxin for 6 hours. The Rao 2017 data are available in <code>Juicebox</code> by default under <code>File &gt; Open</code> menu, “Rao et al. | Cell 2017”. You will want to select the main map for “Auxin treated (6 hrs)”. <!--You can also add a control map by choosing the "Rao et al. | Cell 2017" "Untreated" map. --></p>
<p>Assuming you have already analyzed the data using <code>multiHiCcompare</code> and you now have a <code>Hicexp</code> object containing the comparison results you can use the <code>exportJuicebox</code> function to export the list of DIRs as an annotations file for input into <code>Juicebox</code>. Say your <code>Hicexp</code> object is named <code>rao2017</code> simply run the following line of code in R.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="../reference/exportJuicebox.html">exportJuicebox</a></span>(<span class="kw">rao2017</span>, logfc_cutoff = <span class="fl">2</span>, logcpm_cutoff = <span class="fl">1</span>, p.adj_cutoff = <span class="fl">0.001</span>, file_name = <span class="st">"rao2017Annotations.txt"</span>)
</pre></div>
<p>This function will create a text file in your working directory containing the annotations which can then be imported into <code>Juicebox</code>. This file has been pre-generated, right-click and save it from <a href="https://raw.githubusercontent.com/jstansfield0/Rao2017Annotations/master/rao2017Annotations.txt">here</a>.</p>
<p>Assuming the “Rao et al. | Cell 2017” “Auxin treated (6 hrs)” data is loaded, click the <code>Show Annotation Panel</code> button at the lower right corner of <code>Juicebox</code> window. Alternatively, use the <code>View &gt; Show Annotations Panel</code> menu. Select <code>2D Annotations &gt; Add Local...</code> tab/button, and navigate to the “rao2017Annotations.txt” file. After loading it, the “rao2017Annotations.txt” annotations will be shown in the “Select 2D annotation file(s) to open” panel - select it and click the <code>Open</code> button to load in into <code>Juicebox</code>. Select chromosome 16 in both drop-down menus below the “Chromosomes” selection toolbar and click the refresh button. The DIRs will appear as blue rectangles on the heatmap.</p>
<p><img src="juicebox.png"></p>
<p>Here we can see a screenshot of <code>Juicebox</code> with the Rao 2017 data loaded and our annotations visualized on the heatmap. The blue boxes on the heatmap represent the significant DIRs. You can zoom in or scroll around in the heatmap to better understand where the DIRs occur in relation to each other and on the chromatin map. Use other annotations for more in-depth exploration of the results.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by John Stansfield.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
